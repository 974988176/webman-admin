var st=Object.defineProperty,at=Object.defineProperties;var ct=Object.getOwnPropertyDescriptors;var Ce=Object.getOwnPropertySymbols;var rt=Object.prototype.hasOwnProperty,it=Object.prototype.propertyIsEnumerable;var Ke=(e,t,l)=>t in e?st(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,U=(e,t)=>{for(var l in t||(t={}))rt.call(t,l)&&Ke(e,l,t[l]);if(Ce)for(var l of Ce(t))it.call(t,l)&&Ke(e,l,t[l]);return e},fe=(e,t)=>at(e,ct(t));var te=(e,t,l)=>new Promise((f,S)=>{var v=h=>{try{o(l.next(h))}catch(b){S(b)}},n=h=>{try{o(l.throw(h))}catch(b){S(b)}},o=h=>h.done?f(h.value):Promise.resolve(h.value).then(v,n);o((l=l.apply(e,t)).next())});import{T as ot,B as ut}from"./BasicForm.6307abba.js";import{B as dt,a as ft}from"./index.c145b0a3.js";import{ew as ht,ex as yt,ey as pt,ez as vt,eA as mt,eB as gt,ea as kt,eg as _e,eC as bt,eD as xt,eE as St,eF as Ct,a as re,r as E,eG as Kt,c as _t,f as N,V as Y,o as F,h as G,k as u,aV as Lt,aK as V,aJ as le,p as H,q as Le,t as Ae,cL as At,n as Ee,j as k,eH as Et,F as ae,b2 as wt,dV as Bt,b3 as Tt,b4 as Dt,eI as Ft,cW as se,cb as ce,dj as It,cV as Mt,cv as $t,eJ as Ot,dJ as Nt,a5 as ge,eK as we,ak as Ye,ac as Xe,bR as Ge,cj as ze,eL as Ut,eM as Pt,bz as jt,m as Be,ab as ne,c9 as Rt,ae as Vt,c8 as he,eN as Ht,ep as Yt,a3 as z,eO as Xt,cG as Gt,d7 as zt,w as Te,v as De,cI as qt,b5 as qe,e6 as Fe,eP as Jt,cf as Ie,ci as Wt,aG as Zt,aI as ye,i as X,x as Qt}from"./index.b9fee3a3.js";import{a as pe,b as Me}from"./common.548a9d5e.js";import{D as en}from"./index.ab875217.js";import{g as tn}from"./_baseIteratee.645293d8.js";import{t as nn}from"./util.2d047e79.js";import"./index.efad70d8.js";import"./index.aef99e85.js";import"./index.95528ccd.js";import"./index.c8f8cc06.js";import"./index.20ed4699.js";import"./index.befee6b0.js";import"./index.1e6e3f04.js";import"./index.44110336.js";import"./uniqBy.1d81fed5.js";import"./download.d7c230f8.js";import"./index.24b5a242.js";import"./useWindowSizeFn.3f9c25fc.js";import"./FullscreenOutlined.1c83f2c7.js";var ln=200;function sn(e,t,l,f){var S=-1,v=vt,n=!0,o=e.length,h=[],b=t.length;if(!o)return h;l&&(t=ht(t,yt(l))),f?(v=mt,n=!1):t.length>=ln&&(v=gt,n=!1,t=new pt(t));e:for(;++S<o;){var m=e[S],i=l==null?m:l(m);if(m=f||m!==0?m:0,n&&i===i){for(var s=b;s--;)if(t[s]===i)continue e;h.push(m)}else v(t,i,f)||h.push(m)}return h}var an=kt(function(e,t){return _e(e)?sn(e,bt(t,1,_e,!0)):[]}),cn=an;function rn(e){for(var t=-1,l=e==null?0:e.length,f={};++t<l;){var S=e[t];f[S[0]]=S[1]}return f}function ke(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((l,f)=>l+ke(e,f),""):Object.keys(t).reduce((l,f)=>l+(t[f]?ke(e,f):""),""):""}function on(e){return(t,l)=>(t&&typeof t!="string"&&(l=t,t=""),t=t?`${e}__${t}`:e,`${t}${ke(t,l)}`)}function Je(e){return[on(`${xt}-${e}`)]}const $e=Symbol(),Oe=Symbol();function un(e,t){if(!St(e)||!!e[Oe])return e;const{values:l,required:f,default:S,type:v,validator:n}=e,o=l||n?h=>{let b=!1,m=[];if(l&&(m=[...l,S],b||(b=m.includes(h))),n&&(b||(b=n(h))),!b&&m.length>0){const i=[...new Set(m)].map(s=>JSON.stringify(s)).join(", ");Ct(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${i}], got value ${JSON.stringify(h)}.`)}return b}:void 0;return{type:typeof v=="object"&&Object.getOwnPropertySymbols(v).includes($e)?v[$e]:v,required:!!f,default:S,validator:o,[Oe]:!0}}const dn=e=>rn(Object.entries(e).map(([t,l])=>[t,un(l,t)]));var B=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(B||{});const fn=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],hn=dn({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1}}),yn={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},pn=re({props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const l=e,f=E(""),[S]=Je("tree-header"),v=Kt(),{t:n}=_t(),o=N(()=>{const s=v.headerTitle||l.title;return["mr-1","w-full",{["ml-5"]:s}]}),h=N(()=>{const{checkable:s}=l,a=[{label:n("component.tree.expandAll"),value:B.EXPAND_ALL},{label:n("component.tree.unExpandAll"),value:B.UN_EXPAND_ALL,divider:s}];return s?[{label:n("component.tree.selectAll"),value:B.SELECT_ALL},{label:n("component.tree.unSelectAll"),value:B.UN_SELECT_ALL,divider:s},...a,{label:n("component.tree.checkStrictly"),value:B.CHECK_STRICTLY},{label:n("component.tree.checkUnStrictly"),value:B.CHECK_UN_STRICTLY}]:a});function b(s){var r,d,p,y;const{key:a}=s;switch(a){case B.SELECT_ALL:(r=l.checkAll)==null||r.call(l,!0);break;case B.UN_SELECT_ALL:(d=l.checkAll)==null||d.call(l,!1);break;case B.EXPAND_ALL:(p=l.expandAll)==null||p.call(l,!0);break;case B.UN_EXPAND_ALL:(y=l.expandAll)==null||y.call(l,!1);break;case B.CHECK_STRICTLY:t("strictly-change",!1);break;case B.CHECK_UN_STRICTLY:t("strictly-change",!0);break}}function m(s){t("search",s)}const i=$t(m,200);return Y(()=>f.value,s=>{i(s)}),Y(()=>l.searchText,s=>{s!==f.value&&(f.value=s)}),(s,a)=>(F(),G("div",{class:Ee([u(S)(),"flex px-2 py-1.5 items-center"])},[u(v).headerTitle?Lt(s.$slots,"headerTitle",{key:0}):V("",!0),!u(v).headerTitle&&s.title?(F(),le(u(At),{key:1,helpMessage:s.helpMessage},{default:H(()=>[Le(Ae(s.title),1)]),_:1},8,["helpMessage"])):V("",!0),s.search||s.toolbar?(F(),G("div",yn,[s.search?(F(),G("div",{key:0,class:Ee(u(o))},[k(u(Et),{placeholder:u(n)("common.searchText"),size:"small",allowClear:"",value:f.value,"onUpdate:value":a[0]||(a[0]=r=>f.value=r)},null,8,["placeholder","value"])],2)):V("",!0),s.toolbar?(F(),le(u(Mt),{key:1,onClick:a[1]||(a[1]=It(()=>{},["prevent"]))},{overlay:H(()=>[k(u(se),{onClick:b},{default:H(()=>[(F(!0),G(ae,null,wt(u(h),r=>(F(),G(ae,{key:r.value},[k(u(Bt),Tt(Dt({key:r.value})),{default:H(()=>[Le(Ae(r.label),1)]),_:2},1040),r.divider?(F(),le(u(Ft),{key:0})):V("",!0)],64))),128))]),_:1})]),default:H(()=>[k(u(ce),{icon:"ion:ellipsis-vertical"})]),_:1})):V("",!0)])):V("",!0)],2))}}),vn=({icon:e})=>e?Ot(e)?Nt(ce,{icon:e,class:"mr-1"}):ce:null;function mn(e,t){function l(i){const s=[],a=i||u(e),{key:r,children:d}=u(t);if(!d||!r)return s;for(let p=0;p<a.length;p++){const y=a[p];s.push(y[r]);const x=y[d];x&&x.length&&s.push(...l(x))}return s}function f(i){const s=[],a=i||u(e),{key:r,children:d}=u(t);if(!d||!r)return s;for(let p=0;p<a.length;p++){const y=a[p];y.disabled!==!0&&y.selectable!==!1&&s.push(y[r]);const x=y[d];x&&x.length&&s.push(...f(x))}return s}function S(i,s){const a=[],r=s||u(e),{key:d,children:p}=u(t);if(!p||!d)return a;for(let y=0;y<r.length;y++){const x=r[y],A=x[p];i===x[d]?(a.push(x[d]),A&&A.length&&a.push(...l(A))):A&&A.length&&a.push(...S(i,A))}return a}function v(i,s,a){if(!i)return;const r=a||u(e),{key:d,children:p}=u(t);if(!(!p||!d))for(let y=0;y<r.length;y++){const x=r[y],A=x[p];if(x[d]===i){r[y]=U(U({},r[y]),s);break}else A&&A.length&&v(i,s,x[p])}}function n(i=1,s,a=1){if(!i)return[];const r=[],d=s||u(e)||[];for(let p=0;p<d.length;p++){const y=d[p],{key:x,children:A}=u(t),j=x?y[x]:"",I=A?y[A]:[];r.push(j),I&&I.length&&a<i&&(a+=1,r.push(...n(i,I,a)))}return r}function o({parentKey:i=null,node:s,push:a="push"}){const r=ge(u(e));if(!i){r[a](s),e.value=r;return}const{key:d,children:p}=u(t);!p||!d||(we(r,y=>{if(y[d]===i)return y[p]=y[p]||[],y[p][a](s),!0}),e.value=r)}function h({parentKey:i=null,list:s,push:a="push"}){const r=ge(u(e));if(!(!s||s.length<1))if(i){const{key:d,children:p}=u(t);if(!p||!d)return;we(r,y=>{if(y[d]===i){y[p]=y[p]||[];for(let x=0;x<s.length;x++)y[p][a](s[x]);return e.value=r,!0}})}else for(let d=0;d<s.length;d++)r[a](s[d])}function b(i,s){if(!i)return;const a=s||u(e),{key:r,children:d}=u(t);if(!(!d||!r))for(let p=0;p<a.length;p++){const y=a[p],x=y[d];if(y[r]===i){a.splice(p,1);break}else x&&x.length&&b(i,y[d])}}function m(i,s,a){return!i&&i!==0?null:((s||u(e)).forEach(d=>{if((a==null?void 0:a.key)||(a==null?void 0:a.key)===0)return a;if(d.key===i){a=d;return}d.children&&d.children.length&&(a=m(i,d.children,a))}),a||null)}return{deleteNodeByKey:b,insertNodeByKey:o,insertNodesByKey:h,filterByLevel:n,updateNodeByKey:v,getAllKeys:l,getChildrenKeys:S,getEnabledKeys:f,getSelectedNode:m}}function gn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ze(e)}const ve="context-menu",kn={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}},items:{type:Array,default(){return[]}}},Ne=e=>{const{item:t}=e;return k("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&k(ce,{class:"mr-2",icon:t.icon},null),k("span",null,[t.label])])};var bn=re({name:"ContextMenu",props:kn,setup(e){const t=E(null),l=E(!1),f=N(()=>{const{axis:n,items:o,styles:h,width:b}=e,{x:m,y:i}=n||{x:0,y:0},s=(o||[]).length*40,a=b,r=document.body,d=r.clientWidth<m+a?m-a:m,p=r.clientHeight<i+s?i-s:i;return fe(U({},h),{position:"absolute",width:`${b}px`,left:`${d+1}px`,top:`${p+1}px`,zIndex:9999})});Ye(()=>{Xe(()=>l.value=!0)}),Ge(()=>{const n=u(t);n&&document.body.removeChild(n)});function S(n,o){const{handler:h,disabled:b}=n;b||(l.value=!1,o==null||o.stopPropagation(),o==null||o.preventDefault(),h==null||h())}function v(n){return n.filter(h=>!h.hidden).map(h=>{const{disabled:b,label:m,children:i,divider:s=!1}=h,a={item:h,handler:S,showIcon:e.showIcon};return!i||i.length===0?k(ae,null,[k(se.Item,{disabled:b,class:`${ve}__item`,key:m},{default:()=>[k(Ne,a,null)]}),s?k(en,{key:`d-${m}`},null):null]):u(l)?k(se.SubMenu,{key:m,disabled:b,popupClassName:`${ve}__popup`},{title:()=>k(Ne,a,null),default:()=>v(i)}):null})}return()=>{let n;if(!u(l))return null;const{items:o}=e;return k("div",{class:ve},[k(se,{inlineIndent:12,mode:"vertical",ref:t,style:u(f)},gn(n=v(o))?n:{default:()=>[n]})])}}});const P={domList:[],resolve:()=>{}},xn=function(e){const{event:t}=e||{};if(t&&(t==null||t.preventDefault()),!!Ut)return new Promise(l=>{const f=document.body,S=document.createElement("div"),v={};e.styles&&(v.styles=e.styles),e.items&&(v.items=e.items),e.event&&(v.customEvent=t,v.axis={x:t.clientX,y:t.clientY});const n=k(bn,v);Pt(n,S);const o=function(){P.resolve("")};P.domList.push(S);const h=function(){P.domList.forEach(b=>{try{b&&f.removeChild(b)}catch(m){}}),f.removeEventListener("click",o),f.removeEventListener("scroll",o)};P.resolve=function(b){h(),l(b)},h(),f.appendChild(S),f.addEventListener("click",o),f.addEventListener("scroll",o)})},Ue=function(){P&&(P.resolve(""),P.domList=[])};function Sn(e=!0){return jt()&&e&&Ge(()=>{Ue()}),[xn,Ue]}function Cn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!ze(e)}var Kn=re({name:"BasicTree",inheritAttrs:!1,props:hn,emits:fn,setup(e,{attrs:t,slots:l,emit:f,expose:S}){const[v]=Je("tree"),n=Be({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),o=Be({startSearch:!1,searchText:"",searchData:[]}),h=E([]),[b]=Sn(),m=N(()=>{const{fieldNames:c}=e;return U({children:"children",title:"title",key:"key"},c)}),i=N(()=>{let c=fe(U(U({blockNode:!0},t),e),{expandedKeys:n.expandedKeys,selectedKeys:n.selectedKeys,checkedKeys:n.checkedKeys,checkStrictly:n.checkStrictly,fieldNames:u(m),"onUpdate:expandedKeys":g=>{n.expandedKeys=g,f("update:expandedKeys",g)},"onUpdate:selectedKeys":g=>{n.selectedKeys=g,f("update:selectedKeys",g)},onCheck:(g,K)=>{let C=ne(n.checkedKeys);if(Rt(C)&&o.startSearch){const{key:L}=u(m);C=cn(C,j(K.node.$attrs.node[L])),K.checked&&C.push(K.node.$attrs.node[L]),n.checkedKeys=C}else n.checkedKeys=g;const _=ne(n.checkedKeys);f("update:value",_),f("check",_,K)},onRightClick:ie});return Vt(c,"treeData","class")}),s=N(()=>o.startSearch?o.searchData:u(h)),a=N(()=>!s.value||s.value.length===0),{deleteNodeByKey:r,insertNodeByKey:d,insertNodesByKey:p,filterByLevel:y,updateNodeByKey:x,getAllKeys:A,getChildrenKeys:j,getEnabledKeys:I,getSelectedNode:J}=mn(h,m);function w(c,g){return!g&&e.renderIcon&&he(e.renderIcon)?e.renderIcon(c):g}function ie(K){return te(this,arguments,function*({event:c,node:g}){var M;const{rightMenuList:C=[],beforeRightClick:_}=e;let L={event:c,items:[]};if(_&&he(_)){let T=yield _(g,c);Array.isArray(T)?L.items=T:Object.assign(L,T)}else L.items=C;!((M=L.items)!=null&&M.length)||(L.items=L.items.filter(T=>!T.hidden),b(L))})}function R(c){n.expandedKeys=c}function oe(){return n.expandedKeys}function W(c){n.selectedKeys=c}function Z(){return n.selectedKeys}function be(c){n.checkedKeys=c}function We(){return n.checkedKeys}function xe(c){n.checkedKeys=c?I():[]}function ue(c){n.expandedKeys=c?A():[]}function Ze(c){n.checkStrictly=c}Y(()=>e.searchValue,c=>{c!==o.searchText&&(o.searchText=c)},{immediate:!0}),Y(()=>e.treeData,c=>{c&&de(o.searchText)});function de(c){if(c!==o.searchText&&(o.searchText=c),f("update:searchValue",c),!c){o.startSearch=!1;return}const{filterFn:g,checkable:K,expandOnSearch:C,checkOnSearch:_,selectedOnSearch:L}=u(e);o.startSearch=!0;const{title:M,key:T}=u(m),$=[];if(o.searchData=Ht(u(h),D=>{var Q,ee;const O=g?g(c,D,u(m)):(ee=(Q=D[M])==null?void 0:Q.includes(c))!=null?ee:!1;return O&&$.push(D[T]),O},u(m)),C){const D=Yt(o.searchData).map(O=>O[T]);D&&D.length&&R(D)}_&&K&&$.length&&be($),L&&$.length&&W($)}function Qe(c,g){if(!(!e.clickRowToExpand||!g||g.length===0))if(!n.expandedKeys.includes(c))R([...n.expandedKeys,c]);else{const K=[...n.expandedKeys],C=K.findIndex(_=>_===c);C!==-1&&K.splice(C,1),R(K)}}z(()=>{h.value=e.treeData}),Ye(()=>{const c=parseInt(e.defaultExpandLevel);c>0?n.expandedKeys=y(c):e.defaultExpandAll&&ue(!0)}),z(()=>{n.expandedKeys=e.expandedKeys}),z(()=>{n.selectedKeys=e.selectedKeys}),z(()=>{n.checkedKeys=e.checkedKeys}),Y(()=>e.value,()=>{n.checkedKeys=ne(e.value||[])},{immediate:!0}),Y(()=>n.checkedKeys,()=>{const c=ne(n.checkedKeys);f("update:value",c),f("change",c)}),z(()=>{n.checkStrictly=e.checkStrictly});const et={setExpandedKeys:R,getExpandedKeys:oe,setSelectedKeys:W,getSelectedKeys:Z,setCheckedKeys:be,getCheckedKeys:We,insertNodeByKey:d,insertNodesByKey:p,deleteNodeByKey:r,updateNodeByKey:x,getSelectedNode:J,checkAll:xe,expandAll:ue,filterByLevel:c=>{n.expandedKeys=y(c)},setSearchValue:c=>{de(c)},getSearchValue:()=>o.searchText};function tt(c){const{actionList:g}=e;if(!(!g||g.length===0))return g.map((K,C)=>{var L;let _=!0;return he(K.show)?_=(L=K.show)==null?void 0:L.call(K,c):Ie(K.show)&&(_=K.show),_?k("span",{key:C,class:v("action")},[K.render(c)]):null})}const nt=N(()=>{const c=ge(s.value);return Xt(c,(g,K)=>{var Se;const C=o.searchText,{highlight:_}=u(e),{title:L,key:M,children:T}=u(m),$=w(g,g.icon),D=tn(g,L),O=C?D.indexOf(C):-1,Q=o.startSearch&&!Jt(C)&&_&&O!==-1,ee=`color: ${Ie(_)?"#f50":_}`,lt=Q?k("span",{class:(Se=u(i))!=null&&Se.blockNode?`${v("content")}`:""},[k("span",null,[D.substr(0,O)]),k("span",{style:ee},[C]),k("span",null,[D.substr(O+C.length)])]):D;return g[L]=k("span",{class:`${v("title")} pl-2`,onClick:Qe.bind(null,g[M],g[T])},[l!=null&&l.title?Wt(l,"title",g):k(ae,null,[$&&k(vn,{icon:$},null),lt,k("span",{class:v("actions")},[tt(g)])])]),g}),c});return S(et),()=>{let c;const{title:g,helpMessage:K,toolbar:C,search:_,checkable:L}=e,M=g||C||_||l.headerTitle,T={height:"calc(100% - 38px)"};return k("div",{class:[v(),"h-full",t.class]},[M&&k(pn,{checkable:L,checkAll:xe,expandAll:ue,title:g,search:_,toolbar:C,helpMessage:K,onStrictlyChange:Ze,onSearch:de,searchText:o.searchText},Cn(c=Gt(l))?c:{default:()=>[c]}),k(zt,{spinning:u(e.loading),tip:"\u52A0\u8F7D\u4E2D..."},{default:()=>[Te(k(qt,{style:T},{default:()=>[k(ot,qe(u(i),{showIcon:!1,treeData:nt.value}),null)]}),[[De,!u(a)]]),Te(k(Fe,{image:Fe.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[De,u(a)]])]})])}}});const me=E(null),q=E(null),_n="/app/admin/auth/adminrule/tree",Pe=E(""),je=E(""),Re=E(""),Ve=E(""),He=E([]),Ln=re({components:{BasicForm:ut,BasicModal:dt,BasicTree:Kn},emits:["reload","register"],setup(e,{emit:t}){const l=E("\u6DFB\u52A0\u8BB0\u5F55"),f=E(""),S=E(""),v=E(""),n=E("insert"),o=[],[h,{closeModal:b}]=ft(a=>te(this,null,function*(){var J;S.value=a.column,v.value=a.value,f.value=a.table,Pe.value=a.selectUrl,je.value=a.insertUrl,Re.value=a.updateUrl,Ve.value=a.schemaUrl,S.value?(n.value="edit",l.value="\u7F16\u8F91\u8BB0\u5F55"):(n.value="insert",l.value="\u63D2\u5165\u8BB0\u5F55");const r=yield pe(Ve.value),d=r.forms,p=r.columns,y={};for(let w of p)y[w.field]=w;const x=me.value;if(!x)return;yield x.resetSchema([]);const A={};A[S.value]=v.value;const j=n.value=="edit"?yield pe(Pe.value,A):{},I=n.value=="edit"&&j.items.length?j.items[0]:{};for(let w of d){if(!w.form_show)continue;if(w.field=="rules"){let W=yield pe(_n);He.value=W||[];let Z=((J=I.rules)==null?void 0:J.split(","))||[];Xe(()=>{!q.value||(q.value.setCheckedKeys(Z),q.value.setExpandedKeys(Z))});continue}let[ie,R,oe]=nn(w,I[w.field],n.value);x.appendSchemaByField({field:w.field,component:ie,label:w.comment||w.field,colProps:{span:24},required:n.value=="edit"&&w.field=="password"?!1:!y[w.field].nullable,componentProps:R,defaultValue:oe},"")}})),{createMessage:m}=Qt(),{success:i}=m;return{formElRef:me,treeRef:q,handleSubmit:()=>te(this,null,function*(){var a;try{const r=me.value;if(!r)return;const d=yield r.validate();d.rules=((a=q.value)==null?void 0:a.getCheckedKeys())||[],n.value=="edit"?yield Me(Re.value,{column:S.value,value:v.value,data:d}):yield Me(je.value,{data:d}),b(),i("\u64CD\u4F5C\u6210\u529F"),t("reload")}catch(r){console.log(r)}}),schemas:o,register:h,title:l,treeData:He}}}),An={class:"mt-3"},En={class:"ant-col ant-col-24"},wn={class:"ant-row ant-form-item",style:{"row-gap":"0px"}},Bn=X("div",{class:"ant-col ant-form-item-label",style:{width:"75px"}},[X("label",{class:"ant-form-item-required ant-form-item-no-colon"},"\u6743\u9650")],-1),Tn={class:"ant-col ant-form-item-control",style:{width:"calc(100% - 75px)"}};function Dn(e,t,l,f,S,v){const n=ye("BasicForm"),o=ye("BasicTree"),h=ye("BasicModal");return F(),le(h,qe(e.$attrs,{destroyOnClose:"",onRegister:e.register,title:e.title,onOk:e.handleSubmit}),{default:H(()=>[X("div",An,[k(n,{schemas:e.schemas,ref:"formElRef",labelWidth:75,showActionButtonGroup:!1},null,8,["schemas"]),X("div",En,[X("div",wn,[Bn,X("div",Tn,[k(o,{treeData:e.treeData,ref:"treeRef",checkable:!0,selectable:!1},null,8,["treeData"])])])])])]),_:1},16,["onRegister","title","onOk"])}var el=Zt(Ln,[["render",Dn]]);export{el as default};
