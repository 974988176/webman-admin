var M=(n,d,r)=>new Promise((_,T)=>{var v=i=>{try{o(r.next(i))}catch(y){T(y)}},C=i=>{try{o(r.throw(i))}catch(y){T(y)}},o=i=>i.done?_(i.value):Promise.resolve(i.value).then(v,C);o((r=r.apply(n,d)).next())});import{dY as A,k as E,aG as R,a as U,dZ as O,cW as I,dV as V,cT as z,ce as N,cE as G,aI as c,o as t,h as p,j as b,p as u,t as f,aK as k,F as g,aJ as h,q as m,b2 as P,cH as j,bf as q,x}from"./index.a50f1195.js";import{T as H}from"./index.84efda23.js";import{S as J}from"./index.3666b4e0.js";import{T as K}from"./index.a163d24a.js";import{B as W,u as Y}from"./useTable.6943c6a3.js";import"./BasicForm.9a45028e.js";import{a as Z,b as S,g as Q}from"./common.d4a89cd7.js";import X from"./Login.b3d5b28e.js";import{b as ee}from"./index.d48a9464.js";import"./transButton.fdcb0554.js";import"./CopyOutlined.33bac361.js";import"./index.1803d30b.js";import"./useForm.15936411.js";import"./index.28ab2479.js";import"./index.36ffbcf0.js";import"./index.dad0e93f.js";import"./index.62d8a447.js";import"./useWindowSizeFn.fd0c6515.js";import"./useContentViewHeight.fbfd7f66.js";import"./ArrowLeftOutlined.de48d277.js";import"./index.65aab965.js";import"./_baseIteratee.0f5bf0e1.js";import"./index.08e2204b.js";import"./sortable.esm.c20789c1.js";import"./RedoOutlined.b803bb62.js";import"./FullscreenOutlined.4d9beddb.js";import"./scrollTo.405e18b2.js";import"./index.cd2734ff.js";import"./index.f1e4d655.js";import"./index.81823c62.js";import"./index.0e5d01f2.js";import"./index.734390c3.js";import"./uniqBy.71420ab8.js";import"./download.96873ec9.js";import"./index.da149197.js";import"./useLogin.ed645230.js";function te(n){let d,r=document.body;if(Reflect.has(n,"target")||Reflect.has(n,"props")){const o=n;d=o.props||{},r=o.target||document.body}else d=n;const _=A(d,void 0,!0);return[()=>{const o=E(r);!o||_.open(o)},()=>{_.close()},o=>{_.setTip(o)}]}const ne="/app/admin/plugin/app/list",oe="/app/admin/plugin/app/schema",se=U({components:{BasicTable:W,Tag:H,Switch:J,ModalLogin:X,DropdownButton:O,Menu:I,MenuItem:V,DownOutlined:z,TypographyText:K},setup(){const{createMessage:n}=x(),{success:d,error:r}=n,{refreshMenu:_}=N(),[T,{openModal:v}]=ee(),[C,o]=te({tip:"\u5904\u7406\u4E2D..."});G(()=>M(this,null,function*(){L(yield Z(oe))}));const i=(s,e)=>{y("\u786E\u5B9A\u5378\u8F7D\uFF1F","",function(){w(s,e)})},y=(s,e,l)=>{j.confirm({centered:!0,title:()=>s,icon:()=>b(q),content:()=>b("div",{style:"color:red;"},e),onOk(){l()},class:"test"})};function D(s,e,l){return M(this,null,function*(){if(l==e)return;C(),setTimeout(()=>{o()},3e4);const a=yield S("/app/admin/plugin/app/install",{name:s,version:e});if(o(),a.code==401){v();return}if(a.code){r(a.message);return}location.reload(),d("\u5B89\u88C5\u6210\u529F")})}function w(s,e){return M(this,null,function*(){yield S("/app/admin/plugin/app/uninstall",{name:s,version:e}),B(),_(),d("\u5378\u8F7D\u6210\u529F")})}function F(s){console.log(s)}const[$,{reload:B,setColumns:L}]=Y({api:Q(ne),bordered:!0,showTableSetting:!0});return{registerTable:$,reload:B,onStateChanged:F,install:D,uninstall:w,register:T,showConfirmUninstall:i}}}),ae={class:"p-4"},ie={key:0,style:{"text-align":"left"}},le=m("\u514D\u8D39"),pe=m("\u5378\u8F7D"),ue=m("\u5B89\u88C5");function re(n,d,r,_,T,v){const C=c("Tag"),o=c("Switch"),i=c("TypographyText"),y=c("a-button"),D=c("MenuItem"),w=c("Menu"),F=c("DownOutlined"),$=c("DropdownButton"),B=c("BasicTable"),L=c("ModalLogin");return t(),p("div",ae,[b(B,{onRegister:n.registerTable},{bodyCell:u(({column:s,record:e,text:l})=>[s.key==="title"?(t(),p("div",ie,f(l),1)):k("",!0),s.key==="author"?(t(),p(g,{key:1},[l==="\u5B98\u65B9"?(t(),h(C,{key:0,color:"green"},{default:u(()=>[m(f(l),1)]),_:2},1024)):(t(),p(g,{key:1},[m(f(l),1)],64))],64)):k("",!0),s.key==="state"?(t(),h(o,{key:2,"checked-children":"\u5F00\u542F","un-checked-children":"\u7981\u7528","default-checked":"",class:"extra",checked:e.state,"onUpdate:checked":a=>e.state=a,onChange:a=>n.onStateChanged(e)},null,8,["checked","onUpdate:checked","onChange"])):k("",!0),s.key==="version"?(t(),p(g,{key:3},[e.installed?(t(),p(g,{key:0},[m(f(e.installed),1)],64)):(t(),p(g,{key:1},[m(f(l),1)],64))],64)):k("",!0),s.key==="price"?(t(),p(g,{key:4},[l==0?(t(),h(i,{key:0,type:"success"},{default:u(()=>[le]),_:1})):(t(),h(i,{key:1,type:"danger"},{default:u(()=>[m(f(l)+"\xA5",1)]),_:2},1024))],64)):k("",!0),s.key==="installed"?(t(),p(g,{key:5},[e.installed?(t(),p(g,{key:0},[e.name!=="admin"?(t(),h(y,{key:0,type:"danger",size:"small",onClick:a=>n.showConfirmUninstall(e.name,e.installed)},{default:u(()=>[pe]),_:2},1032,["onClick"])):k("",!0)],64)):(t(),h(y,{key:1,type:"success",size:"small",onClick:a=>n.install(e.name,e.version)},{default:u(()=>[ue]),_:2},1032,["onClick"])),e.installed&&e.releases&&e.releases.length>1?(t(),h($,{key:2,onClick:a=>n.install(e.name,e.version,e.installed),size:"small",type:e.version===e.installed?"info":"success"},{overlay:u(()=>[b(w,null,{default:u(()=>[(t(!0),p(g,null,P(e.releases,a=>(t(),h(D,{key:a,disabled:a===e.installed,onClick:ce=>n.install(e.name,a,e.installed)},{default:u(()=>[m(f(a),1)]),_:2},1032,["disabled","onClick"]))),128))]),_:2},1024)]),icon:u(()=>[b(F)]),default:u(()=>[m(f(e.version===e.installed?"\u964D\u7EA7":"\u5347\u7EA7")+" ",1)]),_:2},1032,["onClick","type"])):k("",!0)],64)):k("",!0)]),_:1},8,["onRegister"]),b(L,{onRegister:n.register,height:350,width:450},null,8,["onRegister"])])}var We=R(se,[["render",re]]);export{We as default};
