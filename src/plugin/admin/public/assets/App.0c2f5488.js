var D=(o,T,k)=>new Promise((v,b)=>{var M=n=>{try{g(k.next(n))}catch(d){b(d)}},w=n=>{try{g(k.throw(n))}catch(d){b(d)}},g=n=>n.done?v(n.value):Promise.resolve(n.value).then(M,w);g((k=k.apply(o,T)).next())});import{aG as E,a as U,dY as O,cW as I,dV as L,cT as R,ce as V,cE as z,aI as c,o as t,h as s,j as C,p as i,t as _,aK as h,F as m,aJ as y,q as l,b2 as N,cH as G,bf as P,x as j}from"./index.82c0877f.js";import{T as q}from"./index.3f591fb8.js";import{S as x}from"./index.966faded.js";import{T as H}from"./index.eb770092.js";import{B as J,u as K}from"./useTable.13c9fc26.js";import"./BasicForm.f0a3b275.js";import{a as W,b as A,g as Y}from"./common.e975f21d.js";import Q from"./Login.6ff49f23.js";import{b as X}from"./index.6147345a.js";import"./transButton.8fe6793e.js";import"./CopyOutlined.8f6de7c5.js";import"./index.8abbad91.js";import"./useForm.743706be.js";import"./index.af52e52a.js";import"./index.cf804cd0.js";import"./index.f0d826d0.js";import"./index.b826f11b.js";import"./useWindowSizeFn.4c098757.js";import"./useContentViewHeight.d9006a19.js";import"./ArrowLeftOutlined.7608b6bc.js";import"./index.ac6fee30.js";import"./_baseIteratee.5798a650.js";import"./index.34c27c3b.js";import"./sortable.esm.c20789c1.js";import"./RedoOutlined.aaf6c144.js";import"./uniqBy.f755cc70.js";import"./scrollTo.b00e6666.js";import"./index.9256000c.js";import"./index.045be6c8.js";import"./index.75341559.js";import"./index.d9c8ab71.js";import"./index.15c3cdec.js";import"./download.0b8d409d.js";import"./useLogin.dd808e9c.js";const Z="/app/admin/plugin/app/list",ee="/app/admin/plugin/app/schema",te=U({components:{BasicTable:J,Tag:q,Switch:x,ModalLogin:Q,DropdownButton:O,Menu:I,MenuItem:L,DownOutlined:R,TypographyText:H},setup(){const{createMessage:o}=j(),{success:T,error:k}=o,{refreshMenu:v}=V(),[b,{openModal:M}]=X();z(()=>D(this,null,function*(){S(yield W(ee))}));const w=(a,p)=>{g("\u786E\u5B9A\u5378\u8F7D\uFF1F","",function(){d(a,p)})},g=(a,p,u)=>{G.confirm({centered:!0,title:()=>a,icon:()=>C(P),content:()=>C("div",{style:"color:red;"},p),onOk(){u()},class:"test"})};function n(a,p,u){return D(this,null,function*(){if(u==p)return;const e=yield A("/app/admin/plugin/app/install",{name:a,version:p});if(e.code==401){M();return}if(e.code){k(e.message);return}B(),v(),T("\u5B89\u88C5\u6210\u529F")})}function d(a,p){return D(this,null,function*(){yield A("/app/admin/plugin/app/uninstall",{name:a,version:p}),B(),v(),T("\u5378\u8F7D\u6210\u529F")})}function F(a){console.log(a)}const[$,{reload:B,setColumns:S}]=K({api:Y(Z),bordered:!0,showTableSetting:!0});return{registerTable:$,reload:B,onStateChanged:F,install:n,uninstall:d,register:b,showConfirmUninstall:w}}}),ne={class:"p-4"},se={key:0,style:{"text-align":"left"}},oe=l("\u514D\u8D39"),ae=l("\u5378\u8F7D"),ie=l("-"),le=l("\u5B89\u88C5");function pe(o,T,k,v,b,M){const w=c("Tag"),g=c("Switch"),n=c("TypographyText"),d=c("a-button"),F=c("MenuItem"),$=c("Menu"),B=c("DownOutlined"),S=c("DropdownButton"),a=c("BasicTable"),p=c("ModalLogin");return t(),s("div",ne,[C(a,{onRegister:o.registerTable},{bodyCell:i(({column:u,record:e,text:f})=>[u.key==="title"?(t(),s("div",se,_(f),1)):h("",!0),u.key==="author"?(t(),s(m,{key:1},[f==="\u5B98\u65B9"?(t(),y(w,{key:0,color:"green"},{default:i(()=>[l(_(f),1)]),_:2},1024)):(t(),s(m,{key:1},[l(_(f),1)],64))],64)):h("",!0),u.key==="state"?(t(),y(g,{key:2,"checked-children":"\u5F00\u542F","un-checked-children":"\u7981\u7528","default-checked":"",class:"extra",checked:e.state,"onUpdate:checked":r=>e.state=r,onChange:r=>o.onStateChanged(e)},null,8,["checked","onUpdate:checked","onChange"])):h("",!0),u.key==="version"?(t(),s(m,{key:3},[e.installed?(t(),s(m,{key:0},[l(_(e.installed),1)],64)):(t(),s(m,{key:1},[l(_(f),1)],64))],64)):h("",!0),u.key==="price"?(t(),s(m,{key:4},[f==0?(t(),y(n,{key:0,type:"success"},{default:i(()=>[oe]),_:1})):(t(),y(n,{key:1,type:"danger"},{default:i(()=>[l(_(f)+"\xA5",1)]),_:2},1024))],64)):h("",!0),u.key==="installed"?(t(),s(m,{key:5},[e.installed?(t(),s(m,{key:0},[e.name!=="admin"?(t(),y(d,{key:0,type:"danger",size:"small",onClick:r=>o.showConfirmUninstall(e.name,e.installed)},{default:i(()=>[ae]),_:2},1032,["onClick"])):(t(),s(m,{key:1},[ie],64))],64)):(t(),y(d,{key:1,type:"success",size:"small",onClick:r=>o.install(e.name,e.version)},{default:i(()=>[le]),_:2},1032,["onClick"])),e.installed&&e.releases&&e.releases.length>1?(t(),y(S,{key:2,onClick:r=>o.install(e.name,e.version,e.installed),size:"small",type:e.version===e.installed?"info":"success"},{overlay:i(()=>[C($,null,{default:i(()=>[(t(!0),s(m,null,N(e.releases,r=>(t(),y(F,{key:r,disabled:r===e.installed,onClick:ue=>o.install(e.name,r,e.installed)},{default:i(()=>[l(_(r),1)]),_:2},1032,["disabled","onClick"]))),128))]),_:2},1024)]),icon:i(()=>[C(B)]),default:i(()=>[l(_(e.version===e.installed?"\u964D\u7EA7":"\u5347\u7EA7")+" ",1)]),_:2},1032,["onClick","type"])):h("",!0)],64)):h("",!0)]),_:1},8,["onRegister"]),C(p,{onRegister:o.register,height:350,width:450},null,8,["onRegister"])])}var xe=E(te,[["render",pe]]);export{xe as default};
