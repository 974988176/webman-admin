var M=(n,y,r)=>new Promise((_,b)=>{var v=a=>{try{o(r.next(a))}catch(k){b(k)}},f=a=>{try{o(r.throw(a))}catch(k){b(k)}},o=a=>a.done?_(a.value):Promise.resolve(a.value).then(v,f);o((r=r.apply(n,y)).next())});import{dY as A,k as E,aG as R,a as U,dZ as O,cW as I,dV as V,cT as z,cE as N,aI as m,o as t,h as p,j as w,p as u,t as h,aK as T,F as g,aJ as C,q as d,b2 as G,cH as j,bf as q,x}from"./index.9e465e98.js";import{T as H}from"./index.17dc3642.js";import{S as J}from"./index.1396ba67.js";import{T as K}from"./index.00160cd6.js";import{B as P,u as W}from"./useTable.656d2bae.js";import"./BasicForm.6056307a.js";import{a as Y,b as S,g as Z}from"./common.6cef50b2.js";import Q from"./Login.e43e7329.js";import{b as X}from"./index.7ea231b7.js";import"./transButton.088152fa.js";import"./CopyOutlined.777ca274.js";import"./index.7cdee0ed.js";import"./useForm.7c9a0ef0.js";import"./index.967f417a.js";import"./index.d342c0df.js";import"./index.82faa0b7.js";import"./index.af33b015.js";import"./useWindowSizeFn.14b10c39.js";import"./useContentViewHeight.c6c711f4.js";import"./ArrowLeftOutlined.8cc9af78.js";import"./index.7e01442e.js";import"./_baseIteratee.2f88fd8b.js";import"./index.892b83b2.js";import"./sortable.esm.c20789c1.js";import"./RedoOutlined.e5187225.js";import"./FullscreenOutlined.0624c6a3.js";import"./scrollTo.e1b29360.js";import"./index.d11f5ba1.js";import"./index.caea034d.js";import"./index.a9758a55.js";import"./index.9dc129cb.js";import"./index.8f156bb7.js";import"./uniqBy.b001b07b.js";import"./download.8926825a.js";import"./index.2c96af2d.js";import"./useLogin.35dbd1a7.js";function ee(n){let y,r=document.body;if(Reflect.has(n,"target")||Reflect.has(n,"props")){const o=n;y=o.props||{},r=o.target||document.body}else y=n;const _=A(y,void 0,!0);return[()=>{const o=E(r);!o||_.open(o)},()=>{_.close()},o=>{_.setTip(o)}]}const te="/app/admin/plugin/app/list",ne="/app/admin/plugin/app/schema",oe=U({components:{BasicTable:P,Tag:H,Switch:J,ModalLogin:Q,DropdownButton:O,Menu:I,MenuItem:V,DownOutlined:z,TypographyText:K},setup(){const{createMessage:n}=x(),{success:y,error:r}=n,[_,{openModal:b}]=X(),[v,f]=ee({tip:"\u5904\u7406\u4E2D..."});N(()=>M(this,null,function*(){L(yield Y(ne))}));const o=(l,s)=>{a("\u786E\u5B9A\u5378\u8F7D\uFF1F","",function(){B(l,s)})},a=(l,s,e)=>{j.confirm({centered:!0,title:()=>l,icon:()=>w(q),content:()=>w("div",{style:"color:red;"},s),onOk(){e()},class:"test"})};function k(l,s,e){return M(this,null,function*(){if(e!=s){v();try{const i=yield S("/app/admin/plugin/app/install",{name:l,version:s},{timeout:6e4});if(i.code==401){b();return}if(i.code){r(i.message);return}y("\u5B89\u88C5\u6210\u529F"),setTimeout(()=>{location.reload()},1e3)}catch(i){}finally{f()}}})}function B(l,s){return M(this,null,function*(){try{v(),yield S("/app/admin/plugin/app/uninstall",{name:l,version:s})}catch(e){f();return}f(),setTimeout(()=>{location.reload()},1e3),y("\u5378\u8F7D\u6210\u529F")})}function D(l){console.log(l)}const[F,{reload:$,setColumns:L}]=W({api:Z(te),bordered:!0,showTableSetting:!0});return{registerTable:F,reload:$,onStateChanged:D,install:k,uninstall:B,register:_,showConfirmUninstall:o}}}),se={class:"p-4"},ae={key:0,style:{"text-align":"left"}},ie=d("\u514D\u8D39"),le=d("\u5378\u8F7D"),pe=d("\u5B89\u88C5");function ue(n,y,r,_,b,v){const f=m("Tag"),o=m("Switch"),a=m("TypographyText"),k=m("a-button"),B=m("MenuItem"),D=m("Menu"),F=m("DownOutlined"),$=m("DropdownButton"),L=m("BasicTable"),l=m("ModalLogin");return t(),p("div",se,[w(L,{onRegister:n.registerTable},{bodyCell:u(({column:s,record:e,text:i})=>[s.key==="title"?(t(),p("div",ae,h(i),1)):T("",!0),s.key==="author"?(t(),p(g,{key:1},[i==="\u5B98\u65B9"?(t(),C(f,{key:0,color:"green"},{default:u(()=>[d(h(i),1)]),_:2},1024)):(t(),p(g,{key:1},[d(h(i),1)],64))],64)):T("",!0),s.key==="state"?(t(),C(o,{key:2,"checked-children":"\u5F00\u542F","un-checked-children":"\u7981\u7528","default-checked":"",class:"extra",checked:e.state,"onUpdate:checked":c=>e.state=c,onChange:c=>n.onStateChanged(e)},null,8,["checked","onUpdate:checked","onChange"])):T("",!0),s.key==="version"?(t(),p(g,{key:3},[e.installed?(t(),p(g,{key:0},[d(h(e.installed),1)],64)):(t(),p(g,{key:1},[d(h(i),1)],64))],64)):T("",!0),s.key==="price"?(t(),p(g,{key:4},[i==0?(t(),C(a,{key:0,type:"success"},{default:u(()=>[ie]),_:1})):(t(),C(a,{key:1,type:"danger"},{default:u(()=>[d(h(i)+"\xA5",1)]),_:2},1024))],64)):T("",!0),s.key==="installed"?(t(),p(g,{key:5},[e.installed?(t(),p(g,{key:0},[e.name!=="admin"?(t(),C(k,{key:0,type:"danger",size:"small",onClick:c=>n.showConfirmUninstall(e.name,e.installed)},{default:u(()=>[le]),_:2},1032,["onClick"])):T("",!0)],64)):(t(),C(k,{key:1,type:"success",size:"small",onClick:c=>n.install(e.name,e.version)},{default:u(()=>[pe]),_:2},1032,["onClick"])),e.installed&&e.releases&&e.releases.length>1?(t(),C($,{key:2,onClick:c=>n.install(e.name,e.version,e.installed),size:"small",type:e.version===e.installed?"info":"success"},{overlay:u(()=>[w(D,null,{default:u(()=>[(t(!0),p(g,null,G(e.releases,c=>(t(),C(B,{key:c,disabled:c===e.installed,onClick:re=>n.install(e.name,c,e.installed)},{default:u(()=>[d(h(c),1)]),_:2},1032,["disabled","onClick"]))),128))]),_:2},1024)]),icon:u(()=>[w(F)]),default:u(()=>[d(h(e.version===e.installed?"\u964D\u7EA7":"\u5347\u7EA7")+" ",1)]),_:2},1032,["onClick","type"])):T("",!0)],64)):T("",!0)]),_:1},8,["onRegister"]),w(l,{onRegister:n.register,height:350,width:450},null,8,["onRegister"])])}var Pe=R(oe,[["render",ue]]);export{Pe as default};
