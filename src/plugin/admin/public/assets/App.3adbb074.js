var D=(o,T,g)=>new Promise((v,b)=>{var M=n=>{try{f(g.next(n))}catch(m){b(m)}},w=n=>{try{f(g.throw(n))}catch(m){b(m)}},f=n=>n.done?v(n.value):Promise.resolve(n.value).then(M,w);f((g=g.apply(o,T)).next())});import{aG as E,a as U,dY as O,cW as I,dV as L,cT as R,ce as V,cE as z,aI as r,o as t,h as a,j as C,p as i,t as _,aK as y,F as d,aJ as k,q as c,b2 as N,cH as G,bf as P,x as j}from"./index.e289dcd8.js";import{T as q}from"./index.4260c328.js";import{S as x}from"./index.91decc82.js";import{T as H}from"./index.eb5bb9c0.js";import{B as J,u as K}from"./useTable.37230393.js";import"./BasicForm.5e329826.js";import{a as W,b as A,g as Y}from"./common.c0183400.js";import Q from"./Login.6eca4c94.js";import{b as X}from"./index.d6a41360.js";import"./transButton.bfabd2f3.js";import"./CopyOutlined.8b1d93c6.js";import"./index.03978f04.js";import"./useForm.71ac6efb.js";import"./index.82d4a460.js";import"./index.b3d327d2.js";import"./index.d47b5783.js";import"./index.eb82b28a.js";import"./useWindowSizeFn.b2708596.js";import"./useContentViewHeight.defec117.js";import"./ArrowLeftOutlined.46ab13ae.js";import"./index.dd651bf1.js";import"./_baseIteratee.6d14cbb8.js";import"./index.d223a9f7.js";import"./sortable.esm.c20789c1.js";import"./RedoOutlined.16bd6227.js";import"./FullscreenOutlined.32e221fd.js";import"./scrollTo.647e97ac.js";import"./index.8a34c9f1.js";import"./index.b516efbb.js";import"./index.feb7d840.js";import"./index.f318367b.js";import"./index.530d1dcd.js";import"./uniqBy.3c476cc7.js";import"./download.88bac90d.js";import"./index.a0c8f05f.js";import"./useLogin.4da405ba.js";const Z="/app/admin/plugin/app/list",ee="/app/admin/plugin/app/schema",te=U({components:{BasicTable:J,Tag:q,Switch:x,ModalLogin:Q,DropdownButton:O,Menu:I,MenuItem:L,DownOutlined:R,TypographyText:H},setup(){const{createMessage:o}=j(),{success:T,error:g}=o,{refreshMenu:v}=V(),[b,{openModal:M}]=X();z(()=>D(this,null,function*(){S(yield W(ee))}));const w=(s,l)=>{f("\u786E\u5B9A\u5378\u8F7D\uFF1F","",function(){m(s,l)})},f=(s,l,p)=>{G.confirm({centered:!0,title:()=>s,icon:()=>C(P),content:()=>C("div",{style:"color:red;"},l),onOk(){p()},class:"test"})};function n(s,l,p){return D(this,null,function*(){if(p==l)return;const e=yield A("/app/admin/plugin/app/install",{name:s,version:l});if(e.code==401){M();return}if(e.code){g(e.message);return}B(),v(),T("\u5B89\u88C5\u6210\u529F")})}function m(s,l){return D(this,null,function*(){yield A("/app/admin/plugin/app/uninstall",{name:s,version:l}),B(),v(),T("\u5378\u8F7D\u6210\u529F")})}function F(s){console.log(s)}const[$,{reload:B,setColumns:S}]=K({api:Y(Z),bordered:!0,showTableSetting:!0});return{registerTable:$,reload:B,onStateChanged:F,install:n,uninstall:m,register:b,showConfirmUninstall:w}}}),ne={class:"p-4"},oe={key:0,style:{"text-align":"left"}},se=c("\u514D\u8D39"),ae=c("\u5378\u8F7D"),ie=c("\u5B89\u88C5");function le(o,T,g,v,b,M){const w=r("Tag"),f=r("Switch"),n=r("TypographyText"),m=r("a-button"),F=r("MenuItem"),$=r("Menu"),B=r("DownOutlined"),S=r("DropdownButton"),s=r("BasicTable"),l=r("ModalLogin");return t(),a("div",ne,[C(s,{onRegister:o.registerTable},{bodyCell:i(({column:p,record:e,text:h})=>[p.key==="title"?(t(),a("div",oe,_(h),1)):y("",!0),p.key==="author"?(t(),a(d,{key:1},[h==="\u5B98\u65B9"?(t(),k(w,{key:0,color:"green"},{default:i(()=>[c(_(h),1)]),_:2},1024)):(t(),a(d,{key:1},[c(_(h),1)],64))],64)):y("",!0),p.key==="state"?(t(),k(f,{key:2,"checked-children":"\u5F00\u542F","un-checked-children":"\u7981\u7528","default-checked":"",class:"extra",checked:e.state,"onUpdate:checked":u=>e.state=u,onChange:u=>o.onStateChanged(e)},null,8,["checked","onUpdate:checked","onChange"])):y("",!0),p.key==="version"?(t(),a(d,{key:3},[e.installed?(t(),a(d,{key:0},[c(_(e.installed),1)],64)):(t(),a(d,{key:1},[c(_(h),1)],64))],64)):y("",!0),p.key==="price"?(t(),a(d,{key:4},[h==0?(t(),k(n,{key:0,type:"success"},{default:i(()=>[se]),_:1})):(t(),k(n,{key:1,type:"danger"},{default:i(()=>[c(_(h)+"\xA5",1)]),_:2},1024))],64)):y("",!0),p.key==="installed"?(t(),a(d,{key:5},[e.installed?(t(),a(d,{key:0},[e.name!=="admin"?(t(),k(m,{key:0,type:"danger",size:"small",onClick:u=>o.showConfirmUninstall(e.name,e.installed)},{default:i(()=>[ae]),_:2},1032,["onClick"])):y("",!0)],64)):(t(),k(m,{key:1,type:"success",size:"small",onClick:u=>o.install(e.name,e.version)},{default:i(()=>[ie]),_:2},1032,["onClick"])),e.installed&&e.releases&&e.releases.length>1?(t(),k(S,{key:2,onClick:u=>o.install(e.name,e.version,e.installed),size:"small",type:e.version===e.installed?"info":"success"},{overlay:i(()=>[C($,null,{default:i(()=>[(t(!0),a(d,null,N(e.releases,u=>(t(),k(F,{key:u,disabled:u===e.installed,onClick:pe=>o.install(e.name,u,e.installed)},{default:i(()=>[c(_(u),1)]),_:2},1032,["disabled","onClick"]))),128))]),_:2},1024)]),icon:i(()=>[C(B)]),default:i(()=>[c(_(e.version===e.installed?"\u964D\u7EA7":"\u5347\u7EA7")+" ",1)]),_:2},1032,["onClick","type"])):y("",!0)],64)):y("",!0)]),_:1},8,["onRegister"]),C(l,{onRegister:o.register,height:350,width:450},null,8,["onRegister"])])}var He=E(te,[["render",le]]);export{He as default};
