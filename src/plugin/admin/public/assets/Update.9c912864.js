var st=Object.defineProperty,at=Object.defineProperties;var it=Object.getOwnPropertyDescriptors;var Ce=Object.getOwnPropertySymbols;var ct=Object.prototype.hasOwnProperty,ot=Object.prototype.propertyIsEnumerable;var Ke=(e,t,r)=>t in e?st(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,P=(e,t)=>{for(var r in t||(t={}))ct.call(t,r)&&Ke(e,r,t[r]);if(Ce)for(var r of Ce(t))ot.call(t,r)&&Ke(e,r,t[r]);return e},pe=(e,t)=>at(e,it(t));var le=(e,t,r)=>new Promise((y,_)=>{var m=p=>{try{d(r.next(p))}catch(k){_(k)}},n=p=>{try{d(r.throw(p))}catch(k){_(k)}},d=p=>p.done?y(p.value):Promise.resolve(p.value).then(m,n);d((r=r.apply(e,t)).next())});import{e as ut,B as dt}from"./BasicForm.948b0243.js";import{B as ft,a as ht}from"./index.4b403226.js";import{es as pt,et as yt,eu as mt,ev as gt,ew as vt,ex as bt,e6 as xt,ec as we,ey as kt,ez as _t,eA as St,eB as Ct,a as oe,r as T,eC as Kt,c as wt,f as U,V as G,o as M,h as q,k as f,aW as Lt,aL as X,aK as se,p as z,q as Le,t as Ae,cL as At,n as Ee,j as x,eD as Et,F as ie,b3 as Tt,dV as Bt,b4 as Dt,b5 as Ft,eE as It,cW as ae,cb as ce,dj as Mt,cV as $t,cv as Ot,eF as Nt,dJ as Ut,a5 as xe,eG as Te,al as Ge,ac as We,bR as qe,cj as Je,eH as Pt,eI as jt,bz as Rt,m as Be,ab as re,c9 as Ht,ae as Yt,c8 as ye,eJ as Xt,el as zt,a3 as J,eK as Gt,cG as Wt,d7 as qt,w as De,v as Fe,cI as Jt,b6 as Ve,e2 as Ie,eL as Vt,cf as Me,ci as Zt,aH as Qt,aJ as me,i as W,x as en}from"./index.bde7963b.js";import{u as $e,t as tn}from"./tree.36c6ae32.js";import{a as ge,b as Oe}from"./common.201fe4f0.js";import{f as nn}from"./fromPairs.84aabb58.js";import{D as ln}from"./index.9b1e5ec7.js";import{g as rn}from"./_baseIteratee.34b68bfe.js";import"./index.0103b3aa.js";import"./index.3289c967.js";import"./index.dcd3d2b7.js";import"./index.18602d99.js";import"./index.bfd670f8.js";import"./index.13318916.js";import"./index.ce7c5e55.js";import"./index.b75cc0a1.js";import"./uniqBy.3333e3da.js";import"./download.dc299cb5.js";import"./useWindowSizeFn.ada338ad.js";var sn=200;function an(e,t,r,y){var _=-1,m=gt,n=!0,d=e.length,p=[],k=t.length;if(!d)return p;r&&(t=pt(t,yt(r))),y?(m=vt,n=!1):t.length>=sn&&(m=bt,n=!1,t=new mt(t));e:for(;++_<d;){var g=e[_],u=r==null?g:r(g);if(g=y||g!==0?g:0,n&&u===u){for(var s=k;s--;)if(t[s]===u)continue e;p.push(g)}else m(t,u,y)||p.push(g)}return p}var cn=xt(function(e,t){return we(e)?an(e,kt(t,1,we,!0)):[]}),on=cn;function ke(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((r,y)=>r+ke(e,y),""):Object.keys(t).reduce((r,y)=>r+(t[y]?ke(e,y):""),""):""}function un(e){return(t,r)=>(t&&typeof t!="string"&&(r=t,t=""),t=t?`${e}__${t}`:e,`${t}${ke(t,r)}`)}function Ze(e){return[un(`${_t}-${e}`)]}const Ne=Symbol(),Ue=Symbol();function dn(e,t){if(!St(e)||!!e[Ue])return e;const{values:r,required:y,default:_,type:m,validator:n}=e,d=r||n?p=>{let k=!1,g=[];if(r&&(g=[...r,_],k||(k=g.includes(p))),n&&(k||(k=n(p))),!k&&g.length>0){const u=[...new Set(g)].map(s=>JSON.stringify(s)).join(", ");Ct(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${u}], got value ${JSON.stringify(p)}.`)}return k}:void 0;return{type:typeof m=="object"&&Object.getOwnPropertySymbols(m).includes(Ne)?m[Ne]:m,required:!!y,default:_,validator:d,[Ue]:!0}}const fn=e=>nn(Object.entries(e).map(([t,r])=>[t,dn(r,t)]));var B=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(B||{});const hn=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],pn=fn({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1}}),yn={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},mn=oe({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const r=e,y=T(""),[_]=Ze("tree-header"),m=Kt(),{t:n}=wt(),d=U(()=>{const s=m.headerTitle||r.title;return["mr-1","w-full",{["ml-5"]:s}]}),p=U(()=>{const{checkable:s}=r,i=[{label:n("component.tree.expandAll"),value:B.EXPAND_ALL},{label:n("component.tree.unExpandAll"),value:B.UN_EXPAND_ALL,divider:s}];return s?[{label:n("component.tree.selectAll"),value:B.SELECT_ALL},{label:n("component.tree.unSelectAll"),value:B.UN_SELECT_ALL,divider:s},...i,{label:n("component.tree.checkStrictly"),value:B.CHECK_STRICTLY},{label:n("component.tree.checkUnStrictly"),value:B.CHECK_UN_STRICTLY}]:i});function k(s){var h,l,a,c;const{key:i}=s;switch(i){case B.SELECT_ALL:(h=r.checkAll)==null||h.call(r,!0);break;case B.UN_SELECT_ALL:(l=r.checkAll)==null||l.call(r,!1);break;case B.EXPAND_ALL:(a=r.expandAll)==null||a.call(r,!0);break;case B.UN_EXPAND_ALL:(c=r.expandAll)==null||c.call(r,!1);break;case B.CHECK_STRICTLY:t("strictly-change",!1);break;case B.CHECK_UN_STRICTLY:t("strictly-change",!0);break}}function g(s){t("search",s)}const u=Ot(g,200);return G(()=>y.value,s=>{u(s)}),G(()=>r.searchText,s=>{s!==y.value&&(y.value=s)}),(s,i)=>(M(),q("div",{class:Ee([f(_)(),"flex px-2 py-1.5 items-center"])},[f(m).headerTitle?Lt(s.$slots,"headerTitle",{key:0}):X("",!0),!f(m).headerTitle&&s.title?(M(),se(f(At),{key:1,helpMessage:s.helpMessage},{default:z(()=>[Le(Ae(s.title),1)]),_:1},8,["helpMessage"])):X("",!0),s.search||s.toolbar?(M(),q("div",yn,[s.search?(M(),q("div",{key:0,class:Ee(f(d))},[x(f(Et),{placeholder:f(n)("common.searchText"),size:"small",allowClear:"",value:y.value,"onUpdate:value":i[0]||(i[0]=h=>y.value=h)},null,8,["placeholder","value"])],2)):X("",!0),s.toolbar?(M(),se(f($t),{key:1,onClick:i[1]||(i[1]=Mt(()=>{},["prevent"]))},{overlay:z(()=>[x(f(ae),{onClick:k},{default:z(()=>[(M(!0),q(ie,null,Tt(f(p),h=>(M(),q(ie,{key:h.value},[x(f(Bt),Dt(Ft({key:h.value})),{default:z(()=>[Le(Ae(h.label),1)]),_:2},1040),h.divider?(M(),se(f(It),{key:0})):X("",!0)],64))),128))]),_:1})]),default:z(()=>[x(f(ce),{icon:"ion:ellipsis-vertical"})]),_:1})):X("",!0)])):X("",!0)],2))}}),gn=({icon:e})=>e?Nt(e)?Ut(ce,{icon:e,class:"mr-1"}):ce:null;function vn(e,t){function r(u){const s=[],i=u||f(e),{key:h,children:l}=f(t);if(!l||!h)return s;for(let a=0;a<i.length;a++){const c=i[a];s.push(c[h]);const b=c[l];b&&b.length&&s.push(...r(b))}return s}function y(u){const s=[],i=u||f(e),{key:h,children:l}=f(t);if(!l||!h)return s;for(let a=0;a<i.length;a++){const c=i[a];c.disabled!==!0&&c.selectable!==!1&&s.push(c[h]);const b=c[l];b&&b.length&&s.push(...y(b))}return s}function _(u,s){const i=[],h=s||f(e),{key:l,children:a}=f(t);if(!a||!l)return i;for(let c=0;c<h.length;c++){const b=h[c],S=b[a];u===b[l]?(i.push(b[l]),S&&S.length&&i.push(...r(S))):S&&S.length&&i.push(..._(u,S))}return i}function m(u,s,i){if(!u)return;const h=i||f(e),{key:l,children:a}=f(t);if(!(!a||!l))for(let c=0;c<h.length;c++){const b=h[c],S=b[a];if(b[l]===u){h[c]=P(P({},h[c]),s);break}else S&&S.length&&m(u,s,b[a])}}function n(u=1,s,i=1){if(!u)return[];const h=[],l=s||f(e)||[];for(let a=0;a<l.length;a++){const c=l[a],{key:b,children:S}=f(t),I=b?c[b]:"",E=S?c[S]:[];h.push(I),E&&E.length&&i<u&&(i+=1,h.push(...n(u,E,i)))}return h}function d({parentKey:u=null,node:s,push:i="push"}){const h=xe(f(e));if(!u){h[i](s),e.value=h;return}const{key:l,children:a}=f(t);!a||!l||(Te(h,c=>{if(c[l]===u)return c[a]=c[a]||[],c[a][i](s),!0}),e.value=h)}function p({parentKey:u=null,list:s,push:i="push"}){const h=xe(f(e));if(!(!s||s.length<1))if(u){const{key:l,children:a}=f(t);if(!a||!l)return;Te(h,c=>{if(c[l]===u){c[a]=c[a]||[];for(let b=0;b<s.length;b++)c[a][i](s[b]);return e.value=h,!0}})}else for(let l=0;l<s.length;l++)h[i](s[l])}function k(u,s){if(!u)return;const i=s||f(e),{key:h,children:l}=f(t);if(!(!l||!h))for(let a=0;a<i.length;a++){const c=i[a],b=c[l];if(c[h]===u){i.splice(a,1);break}else b&&b.length&&k(u,c[l])}}function g(u,s,i){return!u&&u!==0?null:((s||f(e)).forEach(l=>{if((i==null?void 0:i.key)||(i==null?void 0:i.key)===0)return i;if(l.key===u){i=l;return}l.children&&l.children.length&&(i=g(u,l.children,i))}),i||null)}return{deleteNodeByKey:k,insertNodeByKey:d,insertNodesByKey:p,filterByLevel:n,updateNodeByKey:m,getAllKeys:r,getChildrenKeys:_,getEnabledKeys:y,getSelectedNode:g}}function bn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Je(e)}const ve="context-menu",xn={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default(){return{x:0,y:0}}},items:{type:Array,default(){return[]}}},Pe=e=>{const{item:t}=e;return x("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&x(ce,{class:"mr-2",icon:t.icon},null),x("span",null,[t.label])])};var kn=oe({name:"ContextMenu",props:xn,setup(e){const t=T(null),r=T(!1),y=U(()=>{const{axis:n,items:d,styles:p,width:k}=e,{x:g,y:u}=n||{x:0,y:0},s=(d||[]).length*40,i=k,h=document.body,l=h.clientWidth<g+i?g-i:g,a=h.clientHeight<u+s?u-s:u;return pe(P({},p),{position:"absolute",width:`${k}px`,left:`${l+1}px`,top:`${a+1}px`,zIndex:9999})});Ge(()=>{We(()=>r.value=!0)}),qe(()=>{const n=f(t);n&&document.body.removeChild(n)});function _(n,d){const{handler:p,disabled:k}=n;k||(r.value=!1,d==null||d.stopPropagation(),d==null||d.preventDefault(),p==null||p())}function m(n){return n.filter(p=>!p.hidden).map(p=>{const{disabled:k,label:g,children:u,divider:s=!1}=p,i={item:p,handler:_,showIcon:e.showIcon};return!u||u.length===0?x(ie,null,[x(ae.Item,{disabled:k,class:`${ve}__item`,key:g},{default:()=>[x(Pe,i,null)]}),s?x(ln,{key:`d-${g}`},null):null]):f(r)?x(ae.SubMenu,{key:g,disabled:k,popupClassName:`${ve}__popup`},{title:()=>x(Pe,i,null),default:()=>m(u)}):null})}return()=>{let n;if(!f(r))return null;const{items:d}=e;return x("div",{class:ve},[x(ae,{inlineIndent:12,mode:"vertical",ref:t,style:f(y)},bn(n=m(d))?n:{default:()=>[n]})])}}});const j={domList:[],resolve:()=>{}},_n=function(e){const{event:t}=e||{};if(t&&(t==null||t.preventDefault()),!!Pt)return new Promise(r=>{const y=document.body,_=document.createElement("div"),m={};e.styles&&(m.styles=e.styles),e.items&&(m.items=e.items),e.event&&(m.customEvent=t,m.axis={x:t.clientX,y:t.clientY});const n=x(kn,m);jt(n,_);const d=function(){j.resolve("")};j.domList.push(_);const p=function(){j.domList.forEach(k=>{try{k&&y.removeChild(k)}catch(g){}}),y.removeEventListener("click",d),y.removeEventListener("scroll",d)};j.resolve=function(k){p(),r(k)},p(),y.appendChild(_),y.addEventListener("click",d),y.addEventListener("scroll",d)})},je=function(){j&&(j.resolve(""),j.domList=[])};function Sn(e=!0){return Rt()&&e&&qe(()=>{je()}),[_n,je]}function Cn(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Je(e)}var Kn=oe({name:"BasicTree",inheritAttrs:!1,props:pn,emits:hn,setup(e,{attrs:t,slots:r,emit:y,expose:_}){const[m]=Ze("tree"),n=Be({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),d=Be({startSearch:!1,searchText:"",searchData:[]}),p=T([]),[k]=Sn(),g=U(()=>{const{fieldNames:o}=e;return P({children:"children",title:"title",key:"key"},o)}),u=U(()=>{let o=pe(P(P({blockNode:!0},t),e),{expandedKeys:n.expandedKeys,selectedKeys:n.selectedKeys,checkedKeys:n.checkedKeys,checkStrictly:n.checkStrictly,fieldNames:f(g),"onUpdate:expandedKeys":v=>{n.expandedKeys=v,y("update:expandedKeys",v)},"onUpdate:selectedKeys":v=>{n.selectedKeys=v,y("update:selectedKeys",v)},onCheck:(v,K)=>{let C=re(n.checkedKeys);if(Ht(C)&&d.startSearch){const{key:L}=f(g);C=on(C,I(K.node.$attrs.node[L])),K.checked&&C.push(K.node.$attrs.node[L]),n.checkedKeys=C}else n.checkedKeys=v;const w=re(n.checkedKeys);y("update:value",w),y("check",w,K)},onRightClick:Y});return Yt(o,"treeData","class")}),s=U(()=>d.startSearch?d.searchData:f(p)),i=U(()=>!s.value||s.value.length===0),{deleteNodeByKey:h,insertNodeByKey:l,insertNodesByKey:a,filterByLevel:c,updateNodeByKey:b,getAllKeys:S,getChildrenKeys:I,getEnabledKeys:E,getSelectedNode:R}=vn(p,g);function H(o,v){return!v&&e.renderIcon&&ye(e.renderIcon)?e.renderIcon(o):v}function Y(K){return le(this,arguments,function*({event:o,node:v}){var $;const{rightMenuList:C=[],beforeRightClick:w}=e;let L={event:o,items:[]};if(w&&ye(w)){let D=yield w(v,o);Array.isArray(D)?L.items=D:Object.assign(L,D)}else L.items=C;!(($=L.items)!=null&&$.length)||(L.items=L.items.filter(D=>!D.hidden),k(L))})}function A(o){n.expandedKeys=o}function ue(){return n.expandedKeys}function Z(o){n.selectedKeys=o}function de(){return n.selectedKeys}function Q(o){n.checkedKeys=o}function ee(){return n.checkedKeys}function _e(o){n.checkedKeys=o?E():[]}function fe(o){n.expandedKeys=o?S():[]}function Qe(o){n.checkStrictly=o}G(()=>e.searchValue,o=>{o!==d.searchText&&(d.searchText=o)},{immediate:!0}),G(()=>e.treeData,o=>{o&&he(d.searchText)});function he(o){if(o!==d.searchText&&(d.searchText=o),y("update:searchValue",o),!o){d.startSearch=!1;return}const{filterFn:v,checkable:K,expandOnSearch:C,checkOnSearch:w,selectedOnSearch:L}=f(e);d.startSearch=!0;const{title:$,key:D}=f(g),O=[];if(d.searchData=Xt(f(p),F=>{var te,ne;const N=v?v(o,F,f(g)):(ne=(te=F[$])==null?void 0:te.includes(o))!=null?ne:!1;return N&&O.push(F[D]),N},f(g)),C){const F=zt(d.searchData).map(N=>N[D]);F&&F.length&&A(F)}w&&K&&O.length&&Q(O),L&&O.length&&Z(O)}function et(o,v){if(!(!e.clickRowToExpand||!v||v.length===0))if(!n.expandedKeys.includes(o))A([...n.expandedKeys,o]);else{const K=[...n.expandedKeys],C=K.findIndex(w=>w===o);C!==-1&&K.splice(C,1),A(K)}}J(()=>{p.value=e.treeData}),Ge(()=>{const o=parseInt(e.defaultExpandLevel);o>0?n.expandedKeys=c(o):e.defaultExpandAll&&fe(!0)}),J(()=>{n.expandedKeys=e.expandedKeys}),J(()=>{n.selectedKeys=e.selectedKeys}),J(()=>{n.checkedKeys=e.checkedKeys}),G(()=>e.value,()=>{n.checkedKeys=re(e.value||[])},{immediate:!0}),G(()=>n.checkedKeys,()=>{const o=re(n.checkedKeys);y("update:value",o),y("change",o)}),J(()=>{n.checkStrictly=e.checkStrictly});const tt={setExpandedKeys:A,getExpandedKeys:ue,setSelectedKeys:Z,getSelectedKeys:de,setCheckedKeys:Q,getCheckedKeys:ee,insertNodeByKey:l,insertNodesByKey:a,deleteNodeByKey:h,updateNodeByKey:b,getSelectedNode:R,checkAll:_e,expandAll:fe,filterByLevel:o=>{n.expandedKeys=c(o)},setSearchValue:o=>{he(o)},getSearchValue:()=>d.searchText};function nt(o){const{actionList:v}=e;if(!(!v||v.length===0))return v.map((K,C)=>{var L;let w=!0;return ye(K.show)?w=(L=K.show)==null?void 0:L.call(K,o):Me(K.show)&&(w=K.show),w?x("span",{key:C,class:m("action")},[K.render(o)]):null})}const lt=U(()=>{const o=xe(s.value);return Gt(o,(v,K)=>{var Se;const C=d.searchText,{highlight:w}=f(e),{title:L,key:$,children:D}=f(g),O=H(v,v.icon),F=rn(v,L),N=C?F.indexOf(C):-1,te=d.startSearch&&!Vt(C)&&w&&N!==-1,ne=`color: ${Me(w)?"#f50":w}`,rt=te?x("span",{class:(Se=f(u))!=null&&Se.blockNode?`${m("content")}`:""},[x("span",null,[F.substr(0,N)]),x("span",{style:ne},[C]),x("span",null,[F.substr(N+C.length)])]):F;return v[L]=x("span",{class:`${m("title")} pl-2`,onClick:et.bind(null,v[$],v[D])},[r!=null&&r.title?Zt(r,"title",v):x(ie,null,[O&&x(gn,{icon:O},null),rt,x("span",{class:m("actions")},[nt(v)])])]),v}),o});return _(tt),()=>{let o;const{title:v,helpMessage:K,toolbar:C,search:w,checkable:L}=e,$=v||C||w||r.headerTitle,D={height:"calc(100% - 38px)"};return x("div",{class:[m(),"h-full",t.class]},[$&&x(mn,{checkable:L,checkAll:_e,expandAll:fe,title:v,search:w,toolbar:C,helpMessage:K,onStrictlyChange:Qe,onSearch:he,searchText:d.searchText},Cn(o=Wt(r))?o:{default:()=>[o]}),x(qt,{spinning:f(e.loading),tip:"\u52A0\u8F7D\u4E2D..."},{default:()=>[De(x(Jt,{style:D},{default:()=>[x(ut,Ve(f(u),{showIcon:!1,treeData:lt.value}),null)]}),[[Fe,!f(i)]]),De(x(Ie,{image:Ie.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[Fe,f(i)]])]})])}}});const be=T(null),V=T(null),wn="/app/admin/auth/adminrule/tree",Re=T(""),He=T(""),Ye=T(""),Xe=T(""),ze=T([]),Ln=oe({components:{BasicForm:dt,BasicModal:ft,BasicTree:Kn},emits:["reload","register"],setup(e,{emit:t}){const r=T("\u6DFB\u52A0\u8BB0\u5F55"),y=T(""),_=T(""),m=T(""),n=T("insert"),d=[],[p,{closeModal:k}]=ht(l=>le(this,null,function*(){var Y;_.value=l.column,m.value=l.value,y.value=l.table,Re.value=l.selectUrl,He.value=l.insertUrl,Ye.value=l.updateUrl,Xe.value=l.schemaUrl,_.value?(n.value="edit",r.value="\u7F16\u8F91\u8BB0\u5F55"):(n.value="insert",r.value="\u63D2\u5165\u8BB0\u5F55");const a=yield ge(Xe.value),c=a.forms,b=a.columns,S={};for(let A of b)S[A.field]=A;const I=be.value;if(!I)return;yield I.resetSchema([]);const E={};E[_.value]=m.value;const R=n.value=="edit"?yield ge(Re.value,E):{},H=n.value=="edit"&&R.items.length?R.items[0]:{};for(let A of c){if(!A.form_show)continue;if(A.field=="rules"){let Q=yield ge(wn);ze.value=Q||[];let ee=((Y=H.rules)==null?void 0:Y.split(","))||[];We(()=>{!V.value||(V.value.setCheckedKeys(ee),V.value.setExpandedKeys(ee))});continue}let[ue,Z,de]=s(A,H[A.field]);I.appendSchemaByField({field:A.field,component:ue,label:A.comment||A.field,colProps:{span:24},required:n.value=="edit"&&A.field=="password"?!1:!S[A.field].nullable,componentProps:Z,defaultValue:de},"")}})),{createMessage:g}=en(),{success:u}=g;function s(l,a){a=i(a);let c={disabled:n.value=="edit"?!1:l.readonly};if(l.control=="Switch"&&(a=!!a),l.control=="DatePicker"&&(c.showTime=!0),(l.control=="ApiTreeSelect"||l.control=="ApiTree")&&(c.resultField="list",a&&c.multiple&&typeof a!="number"&&(a=a.split(","))),l.control_args)for(let b of l.control_args.split(";")){let S=b.indexOf(":");if(S==-1)continue;let I=b.substring(0,S).trim(),E=b.substring(S+1).trim();if(l.control=="Upload"&&I==="url"){c.api=$e(E);continue}if((l.control=="ApiTreeSelect"||l.control=="ApiTree")&&I==="url"){c.api=tn(E);continue}if(S=E.indexOf(":"),S!==-1){let R=E.split(",");E=[];for(let H of R){let[Y,A]=H.split(":");E.push({value:Y,label:A})}}c[I]=i(E)}return l.control=="Upload"&&(a?(a=a.split(","),c.value=a):c.value=[],c.api||(c.api=$e())),[l.control,c,a]}function i(l){return l==="true"?!0:l==="false"?!1:String(Number(l))===l?Number(l):l}return{formElRef:be,treeRef:V,handleSubmit:()=>le(this,null,function*(){var l;try{const a=be.value;if(!a)return;const c=yield a.validate();c.rules=((l=V.value)==null?void 0:l.getCheckedKeys())||[],n.value=="edit"?yield Oe(Ye.value,{column:_.value,value:m.value,data:c}):yield Oe(He.value,{data:c}),k(),u("\u64CD\u4F5C\u6210\u529F"),t("reload")}catch(a){console.log(a)}}),schemas:d,register:p,title:r,treeData:ze}}}),An={class:"mt-3"},En={class:"ant-col ant-col-24"},Tn={class:"ant-row ant-form-item",style:{"row-gap":"0px"}},Bn=W("div",{class:"ant-col ant-form-item-label",style:{width:"75px"}},[W("label",{class:"ant-form-item-required ant-form-item-no-colon"},"\u6743\u9650")],-1),Dn={class:"ant-col ant-form-item-control",style:{width:"calc(100% - 75px)"}};function Fn(e,t,r,y,_,m){const n=me("BasicForm"),d=me("BasicTree"),p=me("BasicModal");return M(),se(p,Ve(e.$attrs,{destroyOnClose:"",onRegister:e.register,title:e.title,onOk:e.handleSubmit}),{default:z(()=>[W("div",An,[x(n,{schemas:e.schemas,ref:"formElRef",labelWidth:75,showActionButtonGroup:!1},null,8,["schemas"]),W("div",En,[W("div",Tn,[Bn,W("div",Dn,[x(d,{treeData:e.treeData,ref:"treeRef",checkable:!0,selectable:!1},null,8,["treeData"])])])])])]),_:1},16,["onRegister","title","onOk"])}var el=Qt(Ln,[["render",Fn]]);export{el as default};
